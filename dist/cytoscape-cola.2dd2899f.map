{"version":3,"sources":["js/cytoscape-cola.js"],"names":["register","cytoscape","cola","raf","window","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","msRequestAnimationFrame","isString","o","isNumber","isObject","defaults","animate","refresh","maxSimulationTime","ungrabifyWhileSimulating","fit","padding","boundingBox","undefined","ready","stop","randomize","avoidOverlap","handleDisconnected","nodeSpacing","node","flow","alignment","edgeLength","edgeSymDiffLength","edgeJaccardLength","unconstrIter","userConstIter","allConstIter","infinite","ColaLayout","options","opts","i","prototype","run","layout","manuallyStopped","cy","eles","nodes","edges","bb","x1","y1","w","width","h","height","x2","y2","typeoffn","getOptVal","val","ele","fn","apply","updateNodePositions","length","scratch","updatedDims","outerWidth","outerHeight","positions","retPos","grabbed","isParent","x","y","updateCompoundBounds","onReady","onDone","grabbableNodes","grabify","off","destroyHandler","grabHandler","lockHandler","one","trigger","type","ticksPerFrame","tickSkip","Math","abs","max","adaptor","e","TICK","EventType","tick","END","end","kick","inftick","ret","resume","multitick","frame","on","listener","drag","filter","ungrabify","scrCola","pos","position","dragstart","dragend","px","py","fixed","locked","nonparentNodes","stdFilter","map","nbb","struct","round","random","index","offsetsX","offsetsY","forEach","align","push","offset","constraints","axis","offsets","groups","optPadding","getPadding","d","parseFloat","style","pleft","pright","ptop","pbottom","leaves","children","child","lengthFnName","lengthGetter","link","calcLength","links","edge","source","target","c","size","defAxis","defMinSep","minSeparation","flowLayout","avoidOverlaps","start","setTimeout","module","exports","define","amd"],"mappings":"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","file":"cytoscape-cola.2dd2899f.map","sourceRoot":"..","sourcesContent":["/*!\nCopyright (c) The Cytoscape Consortium\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of\nthis software and associated documentation files (the “Software”), to deal in\nthe Software without restriction, including without limitation the rights to\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\nof the Software, and to permit persons to whom the Software is furnished to do\nso, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\n;(function(){ 'use strict';\n\n  // registers the extension on a cytoscape lib ref\n  var register = function( cytoscape, cola ){\n    if( !cytoscape || !cola ){ return; } // can't register if cytoscape unspecified\n\n    var raf = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.msRequestAnimationFrame;\n    var isString = function(o){ return typeof o === typeof ''; };\n    var isNumber = function(o){ return typeof o === typeof 0; };\n    var isObject = function(o){ return o != null && typeof o === typeof {}; };\n\n    // default layout options\n    var defaults = {\n      animate: true, // whether to show the layout as it's running\n      refresh: 1, // number of ticks per frame; higher is faster but more jerky\n      maxSimulationTime: 4000, // max length in ms to run the layout\n      ungrabifyWhileSimulating: false, // so you can't drag nodes during layout\n      fit: true, // on every layout reposition of nodes, fit the viewport\n      padding: 30, // padding around the simulation\n      boundingBox: undefined, // constrain layout bounds; { x1, y1, x2, y2 } or { x1, y1, w, h }\n\n      // layout event callbacks\n      ready: function(){}, // on layoutready\n      stop: function(){}, // on layoutstop\n\n      // positioning options\n      randomize: false, // use random node positions at beginning of layout\n      avoidOverlap: true, // if true, prevents overlap of node bounding boxes\n      handleDisconnected: true, // if true, avoids disconnected components from overlapping\n      nodeSpacing: function( node ){ return 10; }, // extra spacing around nodes\n      flow: undefined, // use DAG/tree flow layout if specified, e.g. { axis: 'y', minSeparation: 30 }\n      alignment: undefined, // relative alignment constraints on nodes, e.g. function( node ){ return { x: 0, y: 1 } }\n\n      // different methods of specifying edge length\n      // each can be a constant numerical value or a function like `function( edge ){ return 2; }`\n      edgeLength: undefined, // sets edge length directly in simulation\n      edgeSymDiffLength: undefined, // symmetric diff edge length in simulation\n      edgeJaccardLength: undefined, // jaccard edge length in simulation\n\n      // iterations of cola algorithm; uses default values on undefined\n      unconstrIter: undefined, // unconstrained initial layout iterations\n      userConstIter: undefined, // initial layout iterations with user-specified constraints\n      allConstIter: undefined, // initial layout iterations with all constraints including non-overlap\n\n      // infinite layout options\n      infinite: false // overrides all other options for a forces-all-the-time mode\n    };\n\n    // constructor\n    // options : object containing layout options\n    function ColaLayout( options ){\n      var opts = this.options = {};\n      for( var i in defaults ){ opts[i] = defaults[i]; }\n      for( var i in options ){ opts[i] = options[i]; }\n    }\n\n    // runs the layout\n    ColaLayout.prototype.run = function(){\n      var layout = this;\n      var options = this.options;\n\n      layout.manuallyStopped = false;\n\n      var cy = options.cy; // cy is automatically populated for us in the constructor\n      var eles = options.eles;\n      var nodes = eles.nodes();\n      var edges = eles.edges();\n      var ready = false;\n\n      var bb = options.boundingBox || { x1: 0, y1: 0, w: cy.width(), h: cy.height() };\n      if( bb.x2 === undefined ){ bb.x2 = bb.x1 + bb.w; }\n      if( bb.w === undefined ){ bb.w = bb.x2 - bb.x1; }\n      if( bb.y2 === undefined ){ bb.y2 = bb.y1 + bb.h; }\n      if( bb.h === undefined ){ bb.h = bb.y2 - bb.y1; }\n\n      var typeoffn = typeof function(){};\n      var getOptVal = function( val, ele ){\n        if( typeof val === typeoffn ){\n          var fn = val;\n          return fn.apply( ele, [ ele ] );\n        } else {\n          return val;\n        }\n      };\n\n      var updateNodePositions = function(){\n        for( var i = 0; i < nodes.length; i++ ){\n          var node = nodes[i];\n          var scratch = node.scratch('cola');\n\n          // update node dims\n          if( !scratch.updatedDims ){\n            var padding = getOptVal( options.nodeSpacing, node );\n\n            scratch.width = node.outerWidth() + 2*padding;\n            scratch.height = node.outerHeight() + 2*padding;\n          }\n        }\n\n        nodes.positions(function(i, node){\n          var scratch = node.scratch().cola;\n          var retPos;\n\n          if( !node.grabbed() && !node.isParent() ){\n            retPos = {\n              x: bb.x1 + scratch.x,\n              y: bb.y1 + scratch.y\n            };\n\n            if( !isNumber(retPos.x) || !isNumber(retPos.y) ){\n              retPos = undefined;\n            }\n          }\n\n          return retPos;\n        });\n\n        nodes.updateCompoundBounds(); // because the way this layout sets positions is buggy for some reason; ref #878\n\n        if( !ready ){\n          onReady();\n          ready = true;\n        }\n\n        if( options.fit ){\n          cy.fit( options.padding );\n        }\n      };\n\n      var onDone = function(){\n        if( options.ungrabifyWhileSimulating ){\n          grabbableNodes.grabify();\n        }\n\n        cy.off('destroy', destroyHandler);\n\n        nodes.off('grab free position', grabHandler);\n        nodes.off('lock unlock', lockHandler);\n\n        // trigger layoutstop when the layout stops (e.g. finishes)\n        layout.one('layoutstop', options.stop);\n        layout.trigger({ type: 'layoutstop', layout: layout });\n      };\n\n      var onReady = function(){\n        // trigger layoutready when each node has had its position set at least once\n        layout.one('layoutready', options.ready);\n        layout.trigger({ type: 'layoutready', layout: layout });\n      };\n\n      var ticksPerFrame = options.refresh;\n      var tickSkip = 1; // frames until a tick; used to slow down sim for debugging\n\n      if( options.refresh < 0 ){\n        tickSkip = Math.abs( options.refresh );\n        ticksPerFrame = 1;\n      } else {\n        ticksPerFrame = Math.max( 1, ticksPerFrame ); // at least 1\n      }\n\n      var adaptor = layout.adaptor = cola.adaptor({\n        trigger: function( e ){ // on sim event\n          var TICK = cola.EventType ? cola.EventType.tick : null;\n          var END = cola.EventType ? cola.EventType.end : null;\n\n          switch( e.type ){\n            case 'tick':\n            case TICK:\n              if( options.animate ){\n                updateNodePositions();\n              }\n              break;\n\n            case 'end':\n            case END:\n              updateNodePositions();\n              if( !options.infinite ){ onDone(); }\n              break;\n          }\n        },\n\n        kick: function(){ // kick off the simulation\n          //var skip = 0;\n\n          var inftick = function(){\n            if( layout.manuallyStopped ){\n              onDone();\n\n              return true;\n            }\n\n            var ret = adaptor.tick();\n\n            if( ret && options.infinite ){ // resume layout if done\n              adaptor.resume(); // resume => new kick\n            }\n\n            return ret; // allow regular finish b/c of new kick\n          };\n\n          var multitick = function(){ // multiple ticks in a row\n            var ret;\n\n            // skip ticks to slow down layout for debugging\n            // var thisSkip = skip;\n            // skip = (skip + 1) % tickSkip;\n            // if( thisSkip !== 0 ){\n            //   return false;\n            // }\n\n            for( var i = 0; i < ticksPerFrame && !ret; i++ ){\n              ret = ret || inftick(); // pick up true ret vals => sim done\n            }\n\n            return ret;\n          };\n\n          if( options.animate ){\n            var frame = function(){\n              if( multitick() ){ return; }\n\n              raf( frame );\n            };\n\n            raf( frame );\n          } else {\n            while( !inftick() ){}\n          }\n        },\n\n        on: function( type, listener ){}, // dummy; not needed\n\n        drag: function(){} // not needed for our case\n      });\n      layout.adaptor = adaptor;\n\n      // if set no grabbing during layout\n      var grabbableNodes = nodes.filter(':grabbable');\n      if( options.ungrabifyWhileSimulating ){\n        grabbableNodes.ungrabify();\n      }\n\n      var destroyHandler;\n      cy.one('destroy', destroyHandler = function(e){\n        layout.stop();\n      });\n\n      // handle node dragging\n      var grabHandler;\n      nodes.on('grab free position', grabHandler = function(e){\n        var node = this;\n        var scrCola = node.scratch().cola;\n        var pos = node.position();\n        \n        switch( e.type ){\n          case 'grab':\n            adaptor.dragstart( scrCola );\n            adaptor.resume();\n            break;\n          case 'free':\n            adaptor.dragend( scrCola );\n            break;\n          case 'position':\n            // only update when different (i.e. manual .position() call or drag) so we don't loop needlessly\n            if( scrCola.x !== pos.x - bb.x1 || scrCola.y !== pos.y - bb.y1 ){\n              scrCola.px = pos.x - bb.x1;\n              scrCola.py = pos.y - bb.y1;\n              adaptor.resume();\n            }\n            break;\n        }\n\n      });\n\n      var lockHandler;\n      nodes.on('lock unlock', lockHandler = function(e){\n        var node = this;\n        var scrCola = node.scratch().cola;\n\n        scrCola.fixed = node.locked();\n\n        if( node.locked() ){\n          adaptor.dragstart( scrCola );\n        } else {\n          adaptor.dragend( scrCola );\n        }\n      });\n\n      var nonparentNodes = nodes.stdFilter(function( node ){\n        return !node.isParent();\n      });\n\n      // add nodes to cola\n      adaptor.nodes( nonparentNodes.map(function( node, i ){\n        var padding = getOptVal( options.nodeSpacing, node );\n        var pos = node.position();\n        var nbb = node.boundingBox();\n\n        var struct = node.scratch().cola = {\n          x: options.randomize || pos.x === undefined ? Math.round( Math.random() * bb.w ) : pos.x,\n          y: options.randomize || pos.y === undefined ? Math.round( Math.random() * bb.h ) : pos.y,\n          width: nbb.w + 2*padding,\n          height: nbb.h + 2*padding,\n          index: i,\n          fixed: node.locked()\n        };\n\n        return struct;\n      }) );\n\n      if( options.alignment ){ // then set alignment constraints\n\n        var offsetsX = [];\n        var offsetsY = [];\n\n        nonparentNodes.forEach(function( node ){\n          var align = getOptVal( options.alignment, node );\n          var scrCola = node.scratch().cola;\n          var index = scrCola.index;\n\n          if( !align ){ return; }\n\n          if( align.x != null ){\n            offsetsX.push({\n              node: index,\n              offset: align.x\n            });\n          }\n\n          if( align.y != null ){\n            offsetsY.push({\n              node: index,\n              offset: align.y\n            });\n          }\n        });\n\n        // add alignment constraints on nodes\n        var constraints = [];\n\n        if( offsetsX.length > 0 ){\n          constraints.push({\n            type: 'alignment',\n            axis: 'x',\n            offsets: offsetsX\n          });\n        }\n\n        if( offsetsY.length > 0 ){\n          constraints.push({\n            type: 'alignment',\n            axis: 'y',\n            offsets: offsetsY\n          });\n        }\n\n        adaptor.constraints( constraints );\n\n      }\n\n      // add compound nodes to cola\n      adaptor.groups( nodes.stdFilter(function( node ){\n        return node.isParent();\n      }).map(function( node, i ){ // add basic group incl leaf nodes\n        var optPadding = getOptVal( options.nodeSpacing, node );\n        var getPadding = function(d){\n          return parseFloat( node.style('padding-'+d) );\n        };\n\n        var pleft = getPadding('left') + optPadding;\n        var pright = getPadding('right') + optPadding;\n        var ptop = getPadding('top') + optPadding;\n        var pbottom = getPadding('bottom') + optPadding;\n\n        node.scratch().cola = {\n          index: i,\n\n          padding: Math.max( pleft, pright, ptop, pbottom ),\n\n          // leaves should only contain direct descendants (children),\n          // not the leaves of nested compound nodes or any nodes that are compounds themselves\n          leaves: node.children().stdFilter(function( child ){\n            return !child.isParent();\n          }).map(function( child ){\n            return child[0].scratch().cola.index;\n          }),\n\n          fixed: node.locked()\n        };\n\n        return node;\n      }).map(function( node ){ // add subgroups\n        node.scratch().cola.groups = node.children().stdFilter(function( child ){\n          return child.isParent();\n        }).map(function( child ){\n          return child.scratch().cola.index;\n        });\n\n        return node.scratch().cola;\n      }) );\n\n      // get the edge length setting mechanism\n      var length;\n      var lengthFnName;\n      if( options.edgeLength != null ){\n        length = options.edgeLength;\n        lengthFnName = 'linkDistance';\n      } else if( options.edgeSymDiffLength != null ){\n        length = options.edgeSymDiffLength;\n        lengthFnName = 'symmetricDiffLinkLengths';\n      } else if( options.edgeJaccardLength != null ){\n        length = options.edgeJaccardLength;\n        lengthFnName = 'jaccardLinkLengths';\n      } else {\n        length = 100;\n        lengthFnName = 'linkDistance';\n      }\n\n      var lengthGetter = function( link ){\n        return link.calcLength;\n      };\n\n      // add the edges to cola\n      adaptor.links( edges.stdFilter(function( edge ){\n        return !edge.source().isParent() && !edge.target().isParent();\n      }).map(function( edge, i ){\n        var c = edge.scratch().cola = {\n          source: edge.source()[0].scratch().cola.index,\n          target: edge.target()[0].scratch().cola.index\n        };\n\n        if( length != null ){\n          c.calcLength = getOptVal( length, edge );\n        }\n\n        return c;\n      }) );\n\n      adaptor.size([ bb.w, bb.h ]);\n\n      if( length != null ){\n        adaptor[ lengthFnName ]( lengthGetter );\n      }\n\n      // set the flow of cola\n      if( options.flow ){\n        var flow;\n        var defAxis = 'y';\n        var defMinSep = 50;\n\n        if( isString(options.flow) ){\n          flow = {\n            axis: options.flow,\n            minSeparation: defMinSep\n          };\n        } else if( isNumber(options.flow) ){\n          flow = {\n            axis: defAxis,\n            minSeparation: options.flow\n          };\n        } else if( isObject(options.flow) ){\n          flow = options.flow;\n\n          flow.axis = flow.axis || defAxis;\n          flow.minSeparation = flow.minSeparation != null ? flow.minSeparation : defMinSep;\n        } else { // e.g. options.flow: true\n          flow = {\n            axis: defAxis,\n            minSeparation: defMinSep\n          };\n        }\n\n        adaptor.flowLayout( flow.axis , flow.minSeparation );\n      }\n\n      layout.trigger({ type: 'layoutstart', layout: layout });\n\n      adaptor\n        .avoidOverlaps( options.avoidOverlap )\n        .handleDisconnected( options.handleDisconnected )\n        .start( options.unconstrIter, options.userConstIter, options.allConstIter)\n      ;\n\n      if( !options.infinite ){\n        setTimeout(function(){\n          if( !layout.manuallyStopped ){\n            adaptor.stop();\n          }\n        }, options.maxSimulationTime);\n      }\n\n      return this; // chaining\n    };\n\n    // called on continuous layouts to stop them before they finish\n    ColaLayout.prototype.stop = function(){\n      if( this.adaptor ){\n        this.manuallyStopped = true;\n        this.adaptor.stop();\n      }\n\n      return this; // chaining\n    };\n\n\n    cytoscape('layout', 'cola', ColaLayout);\n\n  };\n\n  if( typeof module !== 'undefined' && module.exports ){ // expose as a commonjs module\n    module.exports = register;\n  }\n\n  if( typeof define !== 'undefined' && define.amd ){ // expose as an amd/requirejs module\n    define('cytoscape-cola', function(){\n      return register;\n    });\n  }\n\n  if( typeof cytoscape !== 'undefined' && typeof cola !== 'undefined' ){ // expose to global cytoscape (i.e. window.cytoscape)\n    register( cytoscape, cola );\n  }\n\n})();\n"]}